[tox]
envlist = py38,py39,py310,py311,lint,security,docs
isolated_build = true

[testenv]
deps = -r requirements-test.txt
commands = 
    pytest tests/ {posargs}

[testenv:py38]
basepython = python3.8

[testenv:py39]
basepython = python3.9

[testenv:py310]
basepython = python3.10

[testenv:py311]
basepython = python3.11

[testenv:lint]
deps = -r requirements-dev.txt
commands = 
    black --check main.py deploy/ tests/
    isort --check-only main.py deploy/ tests/
    flake8 main.py deploy/ tests/
    pylint main.py deploy/
    mypy main.py deploy/

[testenv:security]
deps = 
    bandit
    safety
commands = 
    bandit -r main.py deploy/
    safety check

[testenv:docs]
deps = 
    sphinx
    sphinx-rtd-theme
commands = 
    sphinx-build -W -b html docs docs/_build/html

[testenv:coverage]
deps = -r requirements-test.txt
commands = 
    pytest --cov=deploy --cov=main --cov-report=html --cov-report=term-missing --cov-fail-under=80